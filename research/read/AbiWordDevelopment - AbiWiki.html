<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta http-equiv="Content-Style-Type" content="text/css" />
		<meta name="generator" content="MediaWiki 1.15.1" />
		<meta name="keywords" content="AbiWordDevelopment,AbiCollab,AbiWord,AbiWord26Plans,AbiWord28Plans,AbiWordFuturePlans,AbiWordVisions,Accessibility,ChangeRecord,Layout Code,MemoryConsumption" />
		<link rel="shortcut icon" href="/favicon.png" />
		<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="AbiWiki (en)" />
		<link title="Creative Commons" type="application/rdf+xml" href="/w/index.php?title=AbiWordDevelopment&amp;action=creativecommons" rel="meta" />
		<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html" />
		<link rel="alternate" type="application/rss+xml" title="AbiWiki RSS Feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=rss" />
		<link rel="alternate" type="application/atom+xml" title="AbiWiki Atom Feed" href="/w/index.php?title=Special:RecentChanges&amp;feed=atom" />
		<title>AbiWordDevelopment - AbiWiki</title>
		<link rel="stylesheet" href="/w/skins/common/shared.css?207" type="text/css" media="screen" />
		<link rel="stylesheet" href="/w/skins/common/commonPrint.css?207" type="text/css" media="print" />
		<link rel="stylesheet" href="/w/skins/monobook/main.css?207" type="text/css" media="screen" />
		<!--[if lt IE 5.5000]><link rel="stylesheet" href="/w/skins/monobook/IE50Fixes.css?207" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 5.5000]><link rel="stylesheet" href="/w/skins/monobook/IE55Fixes.css?207" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 6]><link rel="stylesheet" href="/w/skins/monobook/IE60Fixes.css?207" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 7]><link rel="stylesheet" href="/w/skins/monobook/IE70Fixes.css?207" type="text/css" media="screen" /><![endif]-->
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" type="text/css" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Print.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" type="text/css" media="print" />
		<link rel="stylesheet" href="/w/index.php?title=MediaWiki:Monobook.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" type="text/css" />
		<link rel="stylesheet" href="/w/index.php?title=-&amp;action=raw&amp;maxage=18000&amp;gen=css" type="text/css" />
		<!--[if lt IE 7]><script type="text/javascript" src="/w/skins/common/IEFixes.js?207"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script type= "text/javascript">/*<![CDATA[*/
		var skin = "monobook";
		var stylepath = "/w/skins";
		var wgArticlePath = "/wiki/$1";
		var wgScriptPath = "/w";
		var wgScript = "/w/index.php";
		var wgVariantArticlePath = false;
		var wgActionPaths = {};
		var wgServer = "http://www.abisource.com";
		var wgCanonicalNamespace = "";
		var wgCanonicalSpecialPageName = false;
		var wgNamespaceNumber = 0;
		var wgPageName = "AbiWordDevelopment";
		var wgTitle = "AbiWordDevelopment";
		var wgAction = "view";
		var wgArticleId = "1307";
		var wgIsArticle = true;
		var wgUserName = null;
		var wgUserGroups = null;
		var wgUserLanguage = "en";
		var wgContentLanguage = "en";
		var wgBreakFrames = false;
		var wgCurRevisionId = 4418;
		var wgVersion = "1.15.1";
		var wgEnableAPI = true;
		var wgEnableWriteAPI = true;
		var wgSeparatorTransformTable = ["", ""];
		var wgDigitTransformTable = ["", ""];
		var wgRestrictionEdit = [];
		var wgRestrictionMove = [];
		/*]]>*/</script>

		<script type="text/javascript" src="/w/skins/common/wikibits.js?207"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="/w/skins/common/ajax.js?207"></script>
		<script type="text/javascript" src="/w/index.php?title=-&amp;action=raw&amp;gen=js&amp;useskin=monobook"><!-- site js --></script>
	</head>
<body class="mediawiki ltr ns-0 ns-subject page-AbiWordDevelopment skin-monobook">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 id="firstHeading" class="firstHeading">AbiWordDevelopment</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From AbiWiki</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<table id="toc" class="toc" summary="Contents"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1"><a href="#AbiWord_Development_Area"><span class="tocnumber">1</span> <span class="toctext">AbiWord Development Area</span></a>
<ul>
<li class="toclevel-2"><a href="#Place_content_here_related_to_AbiWord_Development."><span class="tocnumber">1.1</span> <span class="toctext">Place content here related to AbiWord Development.</span></a>
<ul>
<li class="toclevel-3"><a href="#General_Description_of_AbiWord.27s_Layout_code"><span class="tocnumber">1.1.1</span> <span class="toctext">General Description of AbiWord's Layout code</span></a></li>
<li class="toclevel-3"><a href="#Proposals_and_Whacky_Ideas"><span class="tocnumber">1.1.2</span> <span class="toctext">Proposals and Whacky Ideas</span></a></li>
<li class="toclevel-3"><a href="#Accessibility"><span class="tocnumber">1.1.3</span> <span class="toctext">Accessibility</span></a></li>
<li class="toclevel-3"><a href="#Online_document_reader"><span class="tocnumber">1.1.4</span> <span class="toctext">Online document reader</span></a>
<ul>
<li class="toclevel-4"><a href="#Benefits_of_using_abiword_over_a_browser"><span class="tocnumber">1.1.4.1</span> <span class="toctext">Benefits of using abiword over a browser</span></a></li>
</ul>
</li>
<li class="toclevel-3"><a href="#Use_a_cooperate_code_base_rather_than_fork"><span class="tocnumber">1.1.5</span> <span class="toctext">Use a cooperate code base rather than fork</span></a>
<ul>
<li class="toclevel-4"><a href="#Using_a_common_code_base"><span class="tocnumber">1.1.5.1</span> <span class="toctext">Using a common code base</span></a></li>
</ul>
</li>
<li class="toclevel-3"><a href="#Plans"><span class="tocnumber">1.1.6</span> <span class="toctext">Plans</span></a>
<ul>
<li class="toclevel-4"><a href="#TestingFramework"><span class="tocnumber">1.1.6.1</span> <span class="toctext">TestingFramework</span></a></li>
</ul>
</li>
<li class="toclevel-3"><a href="#Performance_Issues."><span class="tocnumber">1.1.7</span> <span class="toctext">Performance Issues.</span></a></li>
<li class="toclevel-3"><a href="#PieceTableBackground"><span class="tocnumber">1.1.8</span> <span class="toctext">PieceTableBackground</span></a>
<ul>
<li class="toclevel-4"><a href="#PieceTable_speedups."><span class="tocnumber">1.1.8.1</span> <span class="toctext">PieceTable speedups.</span></a></li>
<li class="toclevel-4"><a href="#The_UpdateLayout_methods_in_the_fl_SectionLayout_classes"><span class="tocnumber">1.1.8.2</span> <span class="toctext">The UpdateLayout methods in the fl_SectionLayout classes</span></a></li>
<li class="toclevel-4"><a href="#BreakSection"><span class="tocnumber">1.1.8.3</span> <span class="toctext">BreakSection</span></a></li>
<li class="toclevel-4"><a href="#Table_Layout"><span class="tocnumber">1.1.8.4</span> <span class="toctext">Table Layout</span></a></li>
<li class="toclevel-4"><a href="#Table_Layout_2"><span class="tocnumber">1.1.8.5</span> <span class="toctext">Table Layout</span></a></li>
<li class="toclevel-4"><a href="#Plugin_Issues"><span class="tocnumber">1.1.8.6</span> <span class="toctext">Plugin Issues</span></a></li>
<li class="toclevel-4"><a href="#OpenDocument_plugin"><span class="tocnumber">1.1.8.7</span> <span class="toctext">OpenDocument plugin</span></a></li>
<li class="toclevel-4"><a href="#AbiCollab_Collaboration_tool"><span class="tocnumber">1.1.8.8</span> <span class="toctext">AbiCollab Collaboration tool</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2"><a href="#Contributors"><span class="tocnumber">1.2</span> <span class="toctext">Contributors</span></a></li>
</ul>
</li>
</ul>
</td></tr></table><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } </script>
<a name="AbiWord_Development_Area" id="AbiWord_Development_Area"></a><h1> <span class="mw-headline"> <a href="/wiki/AbiWord" title="AbiWord">AbiWord</a> Development Area </span></h1>
<a name="Place_content_here_related_to_AbiWord_Development." id="Place_content_here_related_to_AbiWord_Development."></a><h2> <span class="mw-headline"> Place content here related to <a href="/wiki/AbiWord" title="AbiWord">AbiWord</a> Development. </span></h2>
<a name="General_Description_of_AbiWord.27s_Layout_code" id="General_Description_of_AbiWord.27s_Layout_code"></a><h3> <span class="mw-headline"> General Description of AbiWord's <a href="/w/index.php?title=Layout_code&amp;action=edit&amp;redlink=1" class="new" title="Layout code (page does not exist)">Layout code</a> </span></h3>
<p>See the <a href="/wiki/Layout_Code" title="Layout Code">Layout Code</a> section for this.
</p>
<a name="Proposals_and_Whacky_Ideas" id="Proposals_and_Whacky_Ideas"></a><h3> <span class="mw-headline"> Proposals and Whacky Ideas </span></h3>
<a name="Accessibility" id="Accessibility"></a><h3> <span class="mw-headline"> Accessibility </span></h3>
<p>We need an <a href="/wiki/Accessibility" title="Accessibility">accessibility</a> policy. For example, policy could dictate that all functionality should be available using <a href="/w/index.php?title=Keyboard_navigation&amp;action=edit&amp;redlink=1" class="new" title="Keyboard navigation (page does not exist)">keyboard navigation</a>.
</p>
<a name="Online_document_reader" id="Online_document_reader"></a><h3> <span class="mw-headline"> Online document reader </span></h3>
<p>I am thinking of creating a document reader based on abiword.
</p><p>This would mean adding a facility to hyperlink between documents, and having a document location toolbar, and the facility to communicate via hyper text transfer protocol.
</p><p>There would be no changes server side, but documents would be simply mapped as
abiword files using a URL as follows:
</p><p>http;//foo/bar.abw
</p>
<a name="Benefits_of_using_abiword_over_a_browser" id="Benefits_of_using_abiword_over_a_browser"></a><h4> <span class="mw-headline"> Benefits of using abiword over a browser </span></h4>
<p>The benefits of using abiword over a browser is that abiword supports multipage documents, and it is easy to insert page breaks, and other such formatting in abiword.
</p>
<a name="Use_a_cooperate_code_base_rather_than_fork" id="Use_a_cooperate_code_base_rather_than_fork"></a><h3> <span class="mw-headline"> Use a cooperate code base rather than fork </span></h3>
<p>Ideally it would be useful for the online document reader to use a cooperative codebase with abiword, rather than creating a fork at this stage. This is because abiword still has not matured and some of the document editing facilities, (especially in relation to table editing, etc) are not yet perfected. A fork would mean that the reader would inherit all of the current abiword bugs. The other benefit of using a cooperative code base, is that the insert hyperlink facility could browse existing files, and display anchor points for existing documents on the system, and creating a relative path hyperlink for use by the reader.
</p>
<a name="Using_a_common_code_base" id="Using_a_common_code_base"></a><h4> <span class="mw-headline"> Using a common code base </span></h4>
<p>I propose some sort of code base structure as follows:
</p><p>abiword - This is abiword
abireader - This is the document reader
abicommon - This is the common code base used by both abiword and abireader
</p>
<a name="Plans" id="Plans"></a><h3> <span class="mw-headline"> Plans </span></h3>
<p>Planning for future versions, etc. Hardcopy of ml or IRC discussions in general:
</p>
<ul><li> <a href="/wiki/AbiWord28Plans" title="AbiWord28Plans">AbiWord28Plans</a>
</li><li> <a href="/wiki/AbiWordFuturePlans" title="AbiWordFuturePlans">AbiWordFuturePlans</a>
</li><li> <a href="/wiki/AbiWordVisions" title="AbiWordVisions">AbiWordVisions</a>
</li><li> <a href="/wiki/MemoryConsumption" title="MemoryConsumption">MemoryConsumption</a>
</li><li> Google <a href="/wiki/SummerOfCode" title="SummerOfCode" class="mw-redirect">SummerOfCode</a> Ideas
</li></ul>
<p>Old Plans:
</p>
<ul><li> <a href="/wiki/AbiWord26Plans" title="AbiWord26Plans">AbiWord26Plans</a>
</li></ul>
<p><br />
</p>
<a name="TestingFramework" id="TestingFramework"></a><h4> <span class="mw-headline"> <a href="/w/index.php?title=TestingFramework&amp;action=edit&amp;redlink=1" class="new" title="TestingFramework (page does not exist)">TestingFramework</a> </span></h4>
<p>We try to setup a Framework to automatically test <a href="/wiki/AbiWord" title="AbiWord">AbiWord</a> to ease Quality Assurance and development. The first brick of this framework is the <a href="/wiki/UnitTest" title="UnitTest" class="mw-redirect">UnitTest</a>.
</p>
<a name="Performance_Issues." id="Performance_Issues."></a><h3> <span class="mw-headline"> Performance Issues. </span></h3>
<p><a href="/wiki/AbiWord" title="AbiWord">AbiWord</a> <i>s performance degrades with document size until it becomes barely usable at around 400 pages with reasonable computers.</i>
</p><p>I think that there are a few areas where we can substantially improve performance. To start with we improved the PieceTable as described below.
</p>
<a name="PieceTableBackground" id="PieceTableBackground"></a><h3> <span class="mw-headline">  <a href="/w/index.php?title=PieceTableBackground&amp;action=edit&amp;redlink=1" class="new" title="PieceTableBackground (page does not exist)">PieceTableBackground</a> </span></h3>
<p>Abiword has always used a piece table to store the text (and formatting, more on that later) of a document. The piece table mission
is store the text of the document, and allow you to insert, delete and lookup characters from random locations quickly. Another structure that can be used in a minimalistic editor can be simply an array with some free space at the end (like a std::vector). You will be able to lookup very quickly from an array as v[i] is just a direct lookup in memory, a O(1) operation, but insertion will be very slow as to insert in the i position you have first to move all the elements j &gt; i one position to the right. In the worst case, if you insert at i=0, you will have to move N elements (an O(n) operation). You have the same complexity for a delete operation.
</p><p>As this used to be too slow even for moderately sized documents (I don't know how this will work in modern computers), people started using more complicated algorithms to store text where they can make modifications faster. For instance emacs implemented a "gap array", where they have an array exactly like the one I described, except that the free space (the "gap") was not at the end of the array, but somewhere in the middle (to be more exact, it was at the cursor position). This way to insert a character you add it in the free space and you shrink the gap 1 character. To delete a character you expand the gap 1 character, and to move the cursor position to the left or to the right you just copy 1 character from the left side of the gap to the right side (effectively moving the gap to the left or to the right). As you can imagine, that's not very efficient if you want to make the cursor jump quickly from the beginning of the document to the end, and you get a bit blocked when the gap is exhausted, as emacs has to reallocate the buffer and duplicate it with a new gap (you may haveexperienced this when editing huge documents in emacs).
</p><p>I think this strategy is not appropriate for editors with scroll bars, where people are used to jump randomly in the document way more than a classic emacs user, but it's simple and it works well enough.
</p><p>Abiword (as MS Word) uses a "piece table", it's actually fairly simple. You have 2 arrays, one of them is immutable and contains the original string of characters to edit (the "initial array"), the other one (the "change array") is an empty array with some free space at the end (like a std::vector&lt;char&gt;). We will only append characters to the change array.
</p><p><br />
You also need a list (can be a linked list, more on that later) of "Node"s, each one of them points to a part of the text, they will contain:
</p>
<ul><li> the array that they are pointing to ("initial" or "change")
</li><li> the offset of the text inside this array
</li><li> the size of the text that they point to
</li></ul>
<p>For instance, if your arrays are:
</p>
<dl><dd>Initial: [This is an example]
</dd><dd>Change: []
</dd></dl>
<p>and you have a Node with:
</p>
<dl><dd>buffer: Initial
</dd><dd>offset: 5
</dd><dd>size: 2
</dd></dl>
<p>This node points to the word "is". You start con a list of Nodes of 1 element, the first and only Node will be:
</p>
<dl><dd>buffer: Initial
</dd><dd>offset: 0
</dd><dd>size: size of Initial (18 in our example)
</dd><dd>(from now on, I will represent this like [Initial, 0, 18])
</dd></dl>
<p>This obviously points to the entire original text. When the user inserts a new character, it gets appended to the change buffer, and Nodes are created / splitted to represent the new text. For instance, let's say that you want to insert the character "X" at the end of "This" in the above example, you will end up with the following values in the buffers and in the list of nodes:
</p>
<dl><dd>Initial: [This is an example]
</dd><dd>Change: [X]
</dd><dd>[Initial, 0, 4], [Change, 0, 1], [Initial, 4, 14]
</dd></dl>
<p>To delete a character you don't delete anything in the buffers, you just change a Node from the list of Nodes (splitting it, removing it or shrinking it, depending of the position of the character).
</p><p>Now, insertion and deletion don't depend anymore on the size of the document, but on the number of modifications that the user has
performed in the document. Lookup is also slower, as now it has to find the right piece for a particular offset, again an operation that depends on the number of modifications (O(M)).
</p><p>That fine for MS Word, but at least in Abiword the pieces have been used not only to store the modifications, but also styles. Ie, a node needs to have a uniform style (font, size, etc.). So an empty document doesn't start with a single Node, but with as many nodes as different spans of text you have in the document. The number of Nodes is thus quite big, and this O(M) complexity in lookup, insert and delete is in practice quite expensive.
</p><p>Martin did a few years ago a hack to improve lookup, after every mutation to the piece table, he walked the entire list of Nodes (or "pieces") and created a vector that stored these Nodes and their positions. This way you could do a binary search for positions (a O(log(M)) operation. Insert and deletion became even slower and still O((M))
</p><p><br />
The data structure that Joaquin devised was a way to store this "list of Nodes" in such a way that all the operations are worst case O(log(M)). From here, you can read <a href="http://e98cuenc.free.fr/wordprocessor/piecetable.html" class="external free" title="http://e98cuenc.free.fr/wordprocessor/piecetable.html" rel="nofollow">http://e98cuenc.free.fr/wordprocessor/piecetable.html</a> and it should hopefully make sense.
</p>
<a name="PieceTable_speedups." id="PieceTable_speedups."></a><h4> <span class="mw-headline"> <a href="/wiki/PieceTable" title="PieceTable">PieceTable</a> speedups. </span></h4>
<p>Abiword has a doubly linked-list of fragments which can be any sort of document structure including paragraph blocks and text structures. Each fragment knows it<i>s position in the document and has links to the next and previous fragment. </i>
</p><p>To speed up searches for character positions we have a cache containing the most recently used fragment and a vector of fragment positions. The combination allows to either find the location immediately and to do binary searches for the location of a given position at speed that decreases as log(N) where N is the number of fragments in the document. 
</p><p>However upon insertions or deletions in the piecetable we need to update every fragment downstream of the change. This operation is order (N) where N is the number of fragments. 
</p><p>For a typical 300 page document Tomas estimates we do about 16000 updates for each insertion/deletion event.  That is every time the user presses a key to insert text we need to do 16,000 updates of our document.
</p><p>A few years ago Joaquin Cuenca Abela developed a prototype Piece Table based on a balanced Red/Black tree structure where all operations (search,insert,delete) require Order(Log(N)) operations. 
</p><p><a href="http://e98cuenc.free.fr/wordprocessor/piecetable.html" class="external free" title="http://e98cuenc.free.fr/wordprocessor/piecetable.html" rel="nofollow">http://e98cuenc.free.fr/wordprocessor/piecetable.html</a> 
</p><p>I estimate that the example only requires 30 operations for Joaquin<i>s Piece Table. This is one of the major performance improvements we can make to <a href="/wiki/AbiWord" title="AbiWord">AbiWord</a>. </i>
</p><p>This was implemented during the Google Summer of Code 2009 project by Aditya Manthramurthy and Martin Sevior. The code was merged into AbiWord trunk in May 2010. So now AbiWord has a state of the art PieceTable where all searches, inserts and deletes are done in speed O(LOG(N)).
</p>
<a name="The_UpdateLayout_methods_in_the_fl_SectionLayout_classes" id="The_UpdateLayout_methods_in_the_fl_SectionLayout_classes"></a><h4> <span class="mw-headline"> The <a href="/w/index.php?title=UpdateLayout&amp;action=edit&amp;redlink=1" class="new" title="UpdateLayout (page does not exist)">UpdateLayout</a> methods in the fl_<a href="/w/index.php?title=SectionLayout&amp;action=edit&amp;redlink=1" class="new" title="SectionLayout (page does not exist)">SectionLayout</a> classes </span></h4>
<p>Every time a user presses a key in <a href="/wiki/AbiWord" title="AbiWord">AbiWord</a> the <a href="/wiki/PieceTable" title="PieceTable">PieceTable</a> is modified and new <a href="/wiki/ChangeRecord" title="ChangeRecord">ChangeRecord</a> describing the change is created. These <a href="/w/index.php?title=ChangeRecords&amp;action=edit&amp;redlink=1" class="new" title="ChangeRecords (page does not exist)">ChangeRecords</a> are both saved in an undo stack in the <a href="/wiki/AbiWord" title="AbiWord">AbiWord</a> document and pointers to them are broadcast to every view attached to the document via the FL_<a href="/w/index.php?title=DocListener&amp;action=edit&amp;redlink=1" class="new" title="DocListener (page does not exist)">DocListener</a> class.
</p><p>The change record has a pointer to fl_<a href="/w/index.php?title=BlockLayout&amp;action=edit&amp;redlink=1" class="new" title="BlockLayout (page does not exist)">BlockLayout</a> classes that contains the changed location. This fl_<a href="/w/index.php?title=BlockLayout&amp;action=edit&amp;redlink=1" class="new" title="BlockLayout (page does not exist)">BlockLayout</a> class is called via the appropriate method and updates itself and the physical runs (fp_Run classes) contained by the block.
</p><p>It then calls a method called "format" which breaks text runs into lines which fit into the container that contains the block.
</p><p>At end of every single edit, the method fl_<a href="/w/index.php?title=DocLayout&amp;action=edit&amp;redlink=1" class="new" title="DocLayout (page does not exist)">DocLayout</a>::updateLayout(..) is called. 
</p><p>This scans the entire document looking for blocks that need to be updated. We can speed things up enormously by making adding pointers to a local cache of blocks in each section that need to be formatted.
</p><p>This would speed the process so that instead of requiring N operations for each keypress, it only requires O(1-3) operation.
</p><p>This has now been implemented as of release 2.8.0 for many operations.
</p>
<a name="BreakSection" id="BreakSection"></a><h4> <span class="mw-headline"> <a href="/w/index.php?title=BreakSection&amp;action=edit&amp;redlink=1" class="new" title="BreakSection (page does not exist)">BreakSection</a> </span></h4>
<p>This method in fb_<a href="/w/index.php?title=ColumnBreaker&amp;action=edit&amp;redlink=1" class="new" title="ColumnBreaker (page does not exist)">ColumnBreaker</a> assembles lines (fp_Line) and tables (fp_<a href="/w/index.php?title=TableContainer&amp;action=edit&amp;redlink=1" class="new" title="TableContainer (page does not exist)">TableContainer</a>) onto pages.  It needs to iterate through an entire section after a line changes its position or height.  The length of time this takes is Order(N) where N is the number of lines.
</p><p>It might be possible to solve this order(N) problem for a number of cases using Joaquins<i> Red/Black tree but doing so will be very tricky.  Especially when taken in conjunction with the complexities of break tables across pages.</i>
</p><p>A less ambitious goal and one that would make Abiword appear to be faster, is to just update the pages from the beginning of the document (?) until just after the current on screen page during the keystroke processing, then finish the rest of the update during idle between keystrokes.
</p><p>_Oops&mdash;I had trouble understanding Martin<i>s original paragraph and made some changes including inserting the phrase "from the beginning of the document" in an attempt to clarify.  On further thought&nbsp;;-), and pending clarification from Martin, I realize he might have meant soemthing like "from the insertion point (for the current change / keystroke)" -- Main.<a href="/w/index.php?title=RandyKramer&amp;action=edit&amp;redlink=1" class="new" title="RandyKramer (page does not exist)">RandyKramer</a> - 22 Mar 2005_</i>
</p>
<ul><li>Note*: a while back we tried to format the layout only until the end of the screen. This caused huge problems (crashes) because the x,y coordinates of various layout elements get queried and used even when the elements are not on screen (not sure why). Leaving part of the layout update into idle time would have potentially similar consequences; this is probably the way to go, but it might be initially more disruptive than it appears.
</li></ul>
<a name="Table_Layout" id="Table_Layout"></a><h4> <span class="mw-headline"> Table Layout </span></h4>
<a name="Table_Layout_2" id="Table_Layout_2"></a><h4> <span class="mw-headline"> Table Layout </span></h4>
<p>The current table layout algorithm is adapted from the algorithm used by Gtk+. It is very robust amd handles tables nested to arbitary depth. Unfortunately it takes Order N^2 time to layout tables where is the number of cells.  I<i>ve implemented a few hacks to speed things up while typing for abiword-2.2 but the fundamental problem persists.</i>
</p><p>It may well be worth examining the algorithms used by the gecko layout engine which can position complex tables with thousands of cells extremely quickly.
</p>
<a name="Plugin_Issues" id="Plugin_Issues"></a><h4> <span class="mw-headline"> Plugin Issues </span></h4>
<p>This section describes some of the issues various plugins have, which are not directly bugs.
</p>
<a name="OpenDocument_plugin" id="OpenDocument_plugin"></a><h4> <span class="mw-headline"> <a href="/wiki/OpenDocument" title="OpenDocument">OpenDocument</a> plugin </span></h4>
<a name="AbiCollab_Collaboration_tool" id="AbiCollab_Collaboration_tool"></a><h4> <span class="mw-headline"> <a href="/wiki/AbiCollab" title="AbiCollab">AbiCollab</a> Collaboration tool </span></h4>
<a name="Contributors" id="Contributors"></a><h2> <span class="mw-headline"> Contributors </span></h2>
<ul><li> Main.<a href="/w/index.php?title=MartinSevior&amp;action=edit&amp;redlink=1" class="new" title="MartinSevior (page does not exist)">MartinSevior</a> - 22 Mar 2005
</li><li> Main.<a href="/w/index.php?title=TomasFrydrych&amp;action=edit&amp;redlink=1" class="new" title="TomasFrydrych (page does not exist)">TomasFrydrych</a> - 22 Mar 2005
</li></ul>

<!-- 
NewPP limit report
Preprocessor node count: 89/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key wikidb:pcache:idhash:1307-0!1!0!!en!2!edit=0 and timestamp 20220427043619 -->
<div class="printfooter">
Retrieved from "<a href="http://www.abisource.com/wiki/AbiWordDevelopment">http://www.abisource.com/wiki/AbiWordDevelopment</a>"</div>
			<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks"><a href="/wiki/Special:Categories" title="Special:Categories">Category</a>:&#32;<span dir='ltr'><a href="/wiki/Category:To_Convert" title="Category:To Convert">To Convert</a></span></div></div>			<!-- end content -->
						<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="/wiki/AbiWordDevelopment" title="View the content page [c]" accesskey="c">Page</a></li>
				 <li id="ca-talk" class="new"><a href="/w/index.php?title=Talk:AbiWordDevelopment&amp;action=edit&amp;redlink=1" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				 <li id="ca-viewsource"><a href="/w/index.php?title=AbiWordDevelopment&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				 <li id="ca-history"><a href="/w/index.php?title=AbiWordDevelopment&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="/w/index.php?title=Special:UserLogin&amp;returnto=AbiWordDevelopment" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(/w/skins/common/images/wiki.png);" href="/wiki/Main_Page" title="Visit the main page [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="/wiki/Main_Page">Main Page</a></li>
				<li id="n-portal"><a href="/wiki/AbiWiki:Community_Portal" title="About the project, what you can do, where to find things">Community portal</a></li>
				<li id="n-currentevents"><a href="/wiki/AbiWiki:Current_events" title="Find background information on current events">Current events</a></li>
				<li id="n-recentchanges"><a href="/wiki/Special:RecentChanges" title="The list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
				<li id="n-randompage"><a href="/wiki/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
				<li id="n-help"><a href="/wiki/Help:Contents" title="The place to find out">Help</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/w/index.php" id="searchform"><div>
				<input type='hidden' name="title" value="Special:Search"/>
				<input id="searchInput" name="search" type="text" title="Search AbiWiki [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" title="Go to a page with this exact name if exists" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search the pages for this text" />
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="/wiki/Special:WhatLinksHere/AbiWordDevelopment" title="List of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="/wiki/Special:RecentChangesLinked/AbiWordDevelopment" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-specialpages"><a href="/wiki/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="/w/index.php?title=AbiWordDevelopment&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="/w/index.php?title=AbiWordDevelopment&amp;oldid=4418" title="Permanent link to this revision of the page">Permanent link</a></li>			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="/w/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
				<div id="f-copyrightico"><a href="http://www.gnu.org/copyleft/fdl.html"><img src="/w/skins/common/images/gnu-fdl.png" alt='GNU Free Documentation License 1.2' /></a></div>
			<ul id="f-list">
					<li id="lastmod"> This page was last modified on 30 March 2011, at 23:16.</li>
					<li id="viewcount">This page has been accessed 431,441 times.</li>
					<li id="copyright">Content is available under <a href="http://www.gnu.org/copyleft/fdl.html" class="external " title="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.2</a>.</li>
					<li id="privacy"><a href="/wiki/AbiWiki:Privacy_policy" title="AbiWiki:Privacy policy">Privacy policy</a></li>
					<li id="about"><a href="/wiki/AbiWiki:About" title="AbiWiki:About">About AbiWiki</a></li>
					<li id="disclaimer"><a href="/wiki/AbiWiki:General_disclaimer" title="AbiWiki:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served in 0.114 secs. --></body></html>
