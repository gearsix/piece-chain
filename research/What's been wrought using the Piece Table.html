
<html>
	<head><script src="//archive.org/includes/analytics.js?v=cf34f82" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app221.us.archive.org';v.server_ms=607;archive_analytics.send_pageview({});});</script>
<script type="text/javascript" src="/_static/js/bundle-playback.js?v=36gO9Ebf" charset="utf-8"></script>
<script type="text/javascript" src="/_static/js/wombat.js?v=UHAOicsW" charset="utf-8"></script>
<script type="text/javascript">
  __wm.init("https://web.archive.org/web");
  __wm.wombat("http://1017.songtrellisopml.com/whatsbeenwroughtusingpiecetables","20160308183811","https://web.archive.org/","web","/_static/",
	      "1457462291");
</script>
<link rel="stylesheet" type="text/css" href="/_static/css/banner-styles.css?v=fantwOh2" />
<link rel="stylesheet" type="text/css" href="/_static/css/iconochive.css?v=qtvMKcIJ" />
<!-- End Wayback Rewrite JS Include -->

		<title>Thread: What's been wrought using the Piece Table?</title>
		<link rel="alternate" type="application/rss+xml" title="RSS" href="<%rssUrl%>"/>
		
	
		<link href="https://web.archive.org/web/20160308183811cs_/http://static.scripting.com/github/bootstrap2/css/bootstrap.css" rel="stylesheet">
		<link href="https://web.archive.org/web/20160308183811cs_/http://static.scripting.com/github/bootstrap2/css/prettify.css" rel="stylesheet">
		
		<script src="https://web.archive.org/web/20160308183811js_/http://static.scripting.com/github/bootstrap2/js/jquery.js"></script>
		<script src="https://web.archive.org/web/20160308183811js_/http://static.scripting.com/github/bootstrap2/js/prettify.js"></script>
		<script src="https://web.archive.org/web/20160308183811js_/http://static.scripting.com/github/bootstrap2/js/bootstrap-transition.js"></script>
		<script src="https://web.archive.org/web/20160308183811js_/http://static.scripting.com/github/bootstrap2/js/bootstrap-alert.js"></script>
		<script src="https://web.archive.org/web/20160308183811js_/http://static.scripting.com/github/bootstrap2/js/bootstrap-modal.js"></script>
		<script src="https://web.archive.org/web/20160308183811js_/http://static.scripting.com/github/bootstrap2/js/bootstrap-dropdown.js"></script>
		<script src="https://web.archive.org/web/20160308183811js_/http://static.scripting.com/github/bootstrap2/js/bootstrap-scrollspy.js"></script>
		<script src="https://web.archive.org/web/20160308183811js_/http://static.scripting.com/github/bootstrap2/js/bootstrap-tab.js"></script>
		<script src="https://web.archive.org/web/20160308183811js_/http://static.scripting.com/github/bootstrap2/js/bootstrap-tooltip.js"></script>
		<script src="https://web.archive.org/web/20160308183811js_/http://static.scripting.com/github/bootstrap2/js/bootstrap-popover.js"></script>
		<script src="https://web.archive.org/web/20160308183811js_/http://static.scripting.com/github/bootstrap2/js/bootstrap-button.js"></script>
		<script src="https://web.archive.org/web/20160308183811js_/http://static.scripting.com/github/bootstrap2/js/bootstrap-collapse.js"></script>
		<script src="https://web.archive.org/web/20160308183811js_/http://static.scripting.com/github/bootstrap2/js/bootstrap-carousel.js"></script>
		<script src="https://web.archive.org/web/20160308183811js_/http://static.scripting.com/github/bootstrap2/js/bootstrap-typeahead.js"></script>
		<script src="https://web.archive.org/web/20160308183811js_/http://static.scripting.com/github/bootstrap2/js/application.js"></script>
		
		<script src="https://web.archive.org/web/20160308183811js_/http://static.opml.org/scripts.js"></script>
		<link href="https://web.archive.org/web/20160308183811cs_/http://static.opml.org/styles.css" rel="stylesheet">

		<style>
			.divThePost {
				padding-top: 10px;
				}
			</style>
		</head>
	<body><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<style type="text/css">
body {
  margin-top:0 !important;
  padding-top:0 !important;
  /*min-width:800px !important;*/
}
</style>
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display:none;direction:ltr;">
<div id="wm-ipp" style="position:fixed;left:0;top:0;right:0;">
<div id="donato" style="position:relative;width:100%;">
  <div id="donato-base">
    <iframe id="donato-if" src="https://archive.org/includes/donate.php?as_page=1&amp;platform=wb&amp;referer=https%3A//web.archive.org/web/20160308183811/http%3A//1017.songtrellisopml.com/whatsbeenwroughtusingpiecetables"
	    scrolling="no" frameborder="0" style="width:100%; height:100%">
    </iframe>
  </div>
</div><div id="wm-ipp-inside">
  <div id="wm-toolbar" style="position:relative;display:flex;flex-flow:row nowrap;justify-content:space-between;">
    <div id="wm-logo" style="/*width:110px;*/padding-top:12px;">
      <a href="/web/" title="Wayback Machine home page"><img src="/_static/images/toolbar/wayback-toolbar-logo-200.png" srcset="/_static/images/toolbar/wayback-toolbar-logo-100.png, /_static/images/toolbar/wayback-toolbar-logo-150.png 1.5x, /_static/images/toolbar/wayback-toolbar-logo-200.png 2x" alt="Wayback Machine" style="width:100px" border="0" /></a>
    </div>
    <div class="c" style="display:flex;flex-flow:column nowrap;justify-content:space-between;flex:1;">
      <form class="u" style="display:flex;flex-direction:row;flex-wrap:nowrap;" target="_top" method="get" action="/web/submit" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="http://1017.songtrellisopml.com/whatsbeenwroughtusingpiecetables" onfocus="this.focus();this.select();" style="flex:1;"/><input type="hidden" name="type" value="replay" /><input type="hidden" name="date" value="20160308183811" /><input type="submit" value="Go" />
      </form>
      <div style="display:flex;flex-flow:row nowrap;align-items:flex-end;">
		<div class="s" id="wm-nav-captures">
	  	  <a class="t" href="/web/20160308183811*/http://1017.songtrellisopml.com/whatsbeenwroughtusingpiecetables" title="See a list of every capture for this URL">11 captures</a>
	  <div class="r" title="Timespan for captures of this URL">11 Apr 2014 - 05 Aug 2020</div>
	  </div>
	<div class="k" style="flex:1;">
	  <a href="" id="wm-graph-anchor">
	    <div id="wm-ipp-sparkline" title="Explore captures for this URL" style="position: relative">
	      <canvas id="wm-sparkline-canvas" width="675" height="27" border="0"></canvas>
	    </div>
	  </a>
	</div>
      </div>
    </div>
    <div class="n">
      <table>
	<tbody>
	  <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
	  <tr class="m">
	    <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20150315001837/http://1017.songtrellisopml.com/whatsBeenWroughtUsingPieceTables" title="15 Mar 2015"><strong>Mar</strong></a></td>
	    <td class="c" id="displayMonthEl" title="You are here: 18:38:11 Mar 08, 2016">MAR</td>
	    <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20200521034529/http://1017.songtrellisopml.com/whatsBeenWroughtUsingPieceTables" title="21 May 2020"><strong>May</strong></a></td>
	  </tr>
	  <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
	  <tr class="d">
	    <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20150315001837/http://1017.songtrellisopml.com/whatsBeenWroughtUsingPieceTables" title="00:18:37 Mar 15, 2015"><img src="/_static/images/toolbar/wm_tb_prv_on.png" alt="Previous capture" width="14" height="16" border="0" /></a></td>
	    <td class="c" id="displayDayEl" style="width:34px;font-size:22px;white-space:nowrap;" title="You are here: 18:38:11 Mar 08, 2016">08</td>
	    <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20200521034529/http://1017.songtrellisopml.com/whatsBeenWroughtUsingPieceTables" title="03:45:29 May 21, 2020"><img src="/_static/images/toolbar/wm_tb_nxt_on.png" alt="Next capture" width="14" height="16" border="0" /></a></td>
	  </tr>
	  <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
	  <tr class="y">
	    <td class="b" nowrap="nowrap"><a href="https://web.archive.org/web/20141210184743/http://1017.songtrellisopml.com/whatsBeenWroughtUsingPieceTables" title="10 Dec 2014"><strong>2014</strong></a></td>
	    <td class="c" id="displayYearEl" title="You are here: 18:38:11 Mar 08, 2016">2016</td>
	    <td class="f" nowrap="nowrap"><a href="https://web.archive.org/web/20200521034529/http://1017.songtrellisopml.com/whatsBeenWroughtUsingPieceTables" title="21 May 2020"><strong>2020</strong></a></td>
	  </tr>
	</tbody>
      </table>
    </div>
    <div class="r" style="display:flex;flex-flow:column nowrap;align-items:flex-end;justify-content:space-between;">
      <div id="wm-btns" style="text-align:right;height:23px;">
        	<span class="xxs">
          <div id="wm-save-snapshot-success">success</div>
          <div id="wm-save-snapshot-fail">fail</div>
          <a id="wm-save-snapshot-open" href="#"
	     title="Share via My Web Archive" >
            <span class="iconochive-web"></span>
          </a>
          <a href="https://archive.org/account/login.php" title="Sign In" id="wm-sign-in">
            <span class="iconochive-person"></span>
          </a>
          <span id="wm-save-snapshot-in-progress" class="iconochive-web"></span>
	</span>
        	<a class="xxs" href="http://faq.web.archive.org/" title="Get some help using the Wayback Machine" style="top:-6px;"><span class="iconochive-question" style="color:rgb(87,186,244);font-size:160%;"></span></a>
	<a id="wm-tb-close" href="#close" style="top:-2px;" title="Close the toolbar"><span class="iconochive-remove-circle" style="color:#888888;font-size:240%;"></span></a>
      </div>
      <div id="wm-share" class="xxs">
        <a href="/web/20160308183811/http://web.archive.org/screenshot/http://1017.songtrellisopml.com/whatsbeenwroughtusingpiecetables"
           id="wm-screenshot"
           title="screenshot">
          <span class="wm-icon-screen-shot"></span>
        </a>
        <a href="#" id="wm-video" title="video">
          <span class="iconochive-movies"></span>
        </a>
	<a id="wm-share-facebook" href="#" data-url="https://web.archive.org/web/20160308183811/http://1017.songtrellisopml.com/whatsbeenwroughtusingpiecetables" title="Share on Facebook" style="margin-right:5px;" target="_blank"><span class="iconochive-facebook" style="color:#3b5998;font-size:160%;"></span></a>
	<a id="wm-share-twitter" href="#" data-url="https://web.archive.org/web/20160308183811/http://1017.songtrellisopml.com/whatsbeenwroughtusingpiecetables" title="Share on Twitter" style="margin-right:5px;" target="_blank"><span class="iconochive-twitter" style="color:#1dcaff;font-size:160%;"></span></a>
      </div>
      <div style="padding-right:2px;text-align:right;white-space:nowrap;">
	<a id="wm-expand" class="wm-btn wm-closed" href="#expand" onclick="__wm.ex(event);return false;"><span id="wm-expand-icon" class="iconochive-down-solid"></span> <span class="xxs" style="font-size:80%;">About this capture</span></a>
      </div>
    </div>
  </div>
    <div id="wm-capinfo" style="border-top:1px solid #777;display:none; overflow: hidden">
                    <div id="wm-capinfo-collected-by">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center">COLLECTED BY</div>
    <div style="padding:3px;position:relative" id="wm-collected-by-content">
            <div style="display:inline-block;vertical-align:top;width:50%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/webwidecrawl);"></span>
		Organization: <a style="color:#33f;" href="https://archive.org/details/webwidecrawl" target="_new"><span class="wm-title">Internet Archive</span></a>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  The Internet Archive discovers and captures web pages through many different web crawls.

At any given time several distinct crawls are running, some for months, and some every day or longer.

View the web archive through the <a href="http://archive.org/web/web.php">Wayback Machine</a>.
	</div>
	      </div>
      <div style="display:inline-block;vertical-align:top;width:49%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/wide00014)"></span>
		<div>Collection: <a style="color:#33f;" href="https://archive.org/details/wide00014" target="_new"><span class="wm-title">Wide Crawl Number 14 - Started Mar 4th, 2016 - Ended Sep 15th, 2016</span></a></div>
		<div style="max-height:75px;overflow:hidden;position:relative;">
	  <div style="position:absolute;top:0;left:0;width:100%;height:75px;background:linear-gradient(to bottom,rgba(255,255,255,0) 0%,rgba(255,255,255,0) 90%,rgba(255,255,255,255) 100%);"></div>
	  <span style="font-family: Arial; font-size: 16px;">The seed for Wide00014 was:</span><br style="font-family: Arial; font-size: 16px;"><div style="font-family: Arial; font-size: 16px;"><br></div><div style="font-family: Arial; font-size: 16px;">- Slash pages from every domain on the web:<br><div><br></div><div>-- a list of domains using Survey crawl seeds<br></div><div>-- a list of domains using Wide00012 web graph<br></div><div>-- a list of domains using Wide00013 web graph<br></div></div><div style="font-family: Arial; font-size: 16px;"><br></div><div style="font-family: Arial; font-size: 16px;">- Top ranked pages (up to a max of 100) from every linked-to domain using the Wide00012 inter-domain navigational link graph<br><div><br></div><div>-- a ranking of all URLs that have more than one incoming inter-domain link (rank was determined by number of incoming links using Wide00012 inter domain links)<br></div><div>-- up to a maximum of 100 most highly ranked URLs per domain&nbsp;</div></div><div style="font-family: Arial; font-size: 16px;"><br></div><span style="font-family: Arial; font-size: 16px;">The seed list contains a total of 431,055,452 URLs</span><br style="font-family: Arial; font-size: 16px;"><span style="font-family: Arial; font-size: 16px;">The seed list was further filtered to exclude known porn, and link farm, domains</span><br style="font-family: Arial; font-size: 16px;"><span style="font-family: Arial; font-size: 16px;">The modified seed list contains a total of 428M URLs</span>
	</div>
	      </div>
    </div>
    </div>
    <div id="wm-capinfo-timestamps">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center" title="Timestamps for the elements of this page">TIMESTAMPS</div>
    <div>
      <div id="wm-capresources" style="margin:0 5px 5px 5px;max-height:250px;overflow-y:scroll !important"></div>
      <div id="wm-capresources-loading" style="text-align:left;margin:0 20px 5px 5px;display:none"><img src="/_static/images/loading.gif" alt="loading" /></div>
    </div>
    </div>
  </div></div></div></div><div id="wm-ipp-print">The Wayback Machine - https://web.archive.org/web/20160308183811/http://1017.songtrellisopml.com/whatsbeenwroughtusingpiecetables</div>
<script type="text/javascript">
__wm.bt(675,27,25,2,"web","http://1017.songtrellisopml.com/whatsbeenwroughtusingpiecetables","20160308183811",1996,"/_static/",["/_static/css/banner-styles.css?v=fantwOh2","/_static/css/iconochive.css?v=qtvMKcIJ"], false);
  __wm.rw(1);
</script>
<!-- END WAYBACK TOOLBAR INSERT -->
		
		<div class="divOpmlWebpage">
			<div class="divOpmlWebpageBody">
				<div class="divOpmlNavigation">
					<div class="divPrevNextLinks"><a href="/web/20160308183811/http://1017.songtrellisopml.com/insideMicrosoftWord"><img src="https://web.archive.org/web/20160308183811im_/http://static.scripting.com/glyphicons/glyphicons_216_circle_arrow_left.png" class="woGlyphiconImage" width="26" height="26"></a>&nbsp;<a href="/web/20160308183811/http://1017.songtrellisopml.com/makeRichTextRich"><img src="https://web.archive.org/web/20160308183811im_/http://static.scripting.com/glyphicons/glyphicons_217_circle_arrow_right.png" class="woGlyphiconImage" width="26" height="26"></a></div>
					</div>
				<div class="divOpmlWell">
					<div class="divByline">
						Thread started by <a href="">davidlu</a> now.
						</div>
					<h1>What's been wrought using the Piece Table?</h1>
					<div class="divThePost">
						
<div class="divOutlineBody">
	<div class="divOutlineList" style="padding-left: 0;">
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">A few months before I decided to try to  gain employment with Microsoft back in late 1983, I read about Microsoft Word, which was in its first version for MS-DOS back then. </span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">The feature I read about that fascinated me the most, even more than the idea that you could select text that you wanted to operate on with a mouse, or that text onscreen was laid out as it would look on the page, with bold, italics, underline and strikethough visible in the display, was it's ability to undo the last operation that you'd made to change your document.  And then to redo the operation, if you decided you really needed to make that change after all.  </span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">The first few weeks that I worked at Microsoft before I  began to work on Mac Word 1.0 in June 1984, I was asked to review the manual for the soon-to-ship  PC Word 2.0 to make sure it was describing what the application was actually doing, and as a way to become familiar with Word's technology in detail. </span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">When I was able to do experiments with Word's Undo on a copy of Word 2.0 that ran on the IBM PC I was issued, I became more intrigued. No matter how large a text file or Word document was, I found that one could select thousands of lines of a newly opened text file, and copy it into an empty document in a fraction of a second.</span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;"> No matter how enormous the copied text was, you could undo that change in a fraction of a second, and if you did redo the operation, it was equally fast. </span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;" withallofthetextedit12970><a href="javascript:ec('withAllOfTheTextEdit12970','show','https://web.archive.org/web/20160308183811/http://i.opml.org/rw.gif','https://web.archive.org/web/20160308183811/http://i.opml.org/dw.gif');"><img class="expandIcon" id="img_withAllOfTheTextEdit12970" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/dw.gif" border="0"></a><a onclick="javascript:ec('withAllOfTheTextEdit12970','show','https://web.archive.org/web/20160308183811/http://i.opml.org/rw.gif','https://web.archive.org/web/20160308183811/http://i.opml.org/dw.gif');"><span class="spanOutlineText spanExpandableText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">With all of the text editors that I had used up to that point, including some that it been my job to modify and maintain, if you were copying an extremely large selection of text, you had to pay for executing that kind of operation by waiting longer than an eyeblink and sometimes for a good number of breaths for such an operation to complete. </span></a></p>
		<div class="show" id="withAllOfTheTextEdit12970" name="withAllOfTheTextEdit12970">
			<div class="divOutlineList" style="padding-left: 30px;">
				<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">In extreme cases, the wait would be so long, there was time to leave the room to get a soda, or a cup of coffee.</span></p>
				</div>
			</div>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">When I used Word I never had to pay that cost.</span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">How did the Word team do that? I was really anxious to find out. </span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">It took several months before my curiousity was satisfied. </span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;" atatimewhenweneededt5334><a href="javascript:ec('atATimeWhenWeNeededT5334','show','https://web.archive.org/web/20160308183811/http://i.opml.org/rw.gif','https://web.archive.org/web/20160308183811/http://i.opml.org/dw.gif');"><img class="expandIcon" id="img_atATimeWhenWeNeededT5334" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/dw.gif" border="0"></a><a onclick="javascript:ec('atATimeWhenWeNeededT5334','show','https://web.archive.org/web/20160308183811/http://i.opml.org/rw.gif','https://web.archive.org/web/20160308183811/http://i.opml.org/dw.gif');"><span class="spanOutlineText spanExpandableText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">At a time when we needed to know, Charles Simonyi diagrammed on his white board how Word edits worked for me and Rob Horowitz, another novice Microsoft engineer assigned to the Mac Word 1.0 (Sand Word) project. </span></a></p>
		<div class="show" id="atATimeWhenWeNeededT5334" name="atATimeWhenWeNeededT5334">
			<div class="divOutlineList" style="padding-left: 30px;">
				<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;"><a href="https://web.archive.org/web/20160308183811/http://forums.macrumors.com/showthread.php?t=2949" class="aOutlineDocLink">Steve Jobs had given a visionary talk, that Jeff Harbers of Microsoft had experienced, describing how sand, a source for the silicon substrate of computer chips, could enter one portal of a factory and a finished computer with its associated software could be shipped as the final product. So our contibution to his vision was Sand Word.</a></span></p>
				</div>
			</div>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">Word's editing speed and ability to Undo and Redo depended on a data structure called a piece table. </span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">J Strother Moore, a computer scientist who worked at Xerox PARC when Simonyi was on staff  in 1974, had invented the piece table as a side-consequence of work he did on representing logic clauses within software that proved theorems. </span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">He had realized that when one edited a text, it was not necessary to represent the edit result as one long string of characters recorded in a buffer. </span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;" usingthatnaivetextre19949><a href="javascript:ec('usingThatNaiveTextRe19949','show','https://web.archive.org/web/20160308183811/http://i.opml.org/rw.gif','https://web.archive.org/web/20160308183811/http://i.opml.org/dw.gif');"><img class="expandIcon" id="img_usingThatNaiveTextRe19949" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/dw.gif" border="0"></a><a onclick="javascript:ec('usingThatNaiveTextRe19949','show','https://web.archive.org/web/20160308183811/http://i.opml.org/rw.gif','https://web.archive.org/web/20160308183811/http://i.opml.org/dw.gif');"><span class="spanOutlineText spanExpandableText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;"> Using that naive text representation lead to the big waits that occurred when one inserted hundreds of thousands of characters into the middle of existing text.</span></a></p>
		<div class="show" id="usingThatNaiveTextRe19949" name="usingThatNaiveTextRe19949">
			<div class="divOutlineList" style="padding-left: 30px;">
				<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">In the naive method, you would have to first make room for the newly added characters in a text buffer by moving all characters at the insertion point to the right by the number of characters that were to be added and then copy the new text into the gap that was created.   </span></p>
				<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">In 1970's software, a process that copied hundreds of thousands of characters,  cost time that could be measured by watching a clock's second hand, whenever such an operation occured during a program's execution. This was especially noticeable when a large copy operation required that the copied bytes be reflected to a disk file as a measure to preserve space within a program's precious and limited-in-size internal memory allocation.</span></p>
				</div>
			</div>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">Instead of moving text in a document into one contiguous string, one could, instead, write a small set of records, consisting of only a few bytes of data, that described how a text string was fragmented into pieces as it was edited. </span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">When text existed already in a file, when that file was opened, a type of record, call it a piece description, could be created that showed where text began in the file, and how many characters were contiguously recorded after that point in the file.  </span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">If newly typed characters needed to be added to the middle of that text, that single piece description could be fragmented into two pieces. The descriptors for those pieces, would then point to the location of the first character of text up to the insertion point, and then to the location of the character after the insertion up to the end of the original text. </span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">Then a third record could be created that describes the text that was newly typed, which records where that new text was recorded, which could be in memory somelace or in a temporary scratch file rceorded on the computer's file system. That new record could be placed between the beginning and ending piece that bracketed the  point of insertion. </span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;" thissequenceofdescri31807><a href="javascript:ec('thisSequenceOfDescri31807','show','https://web.archive.org/web/20160308183811/http://i.opml.org/rw.gif','https://web.archive.org/web/20160308183811/http://i.opml.org/dw.gif');"><img class="expandIcon" id="img_thisSequenceOfDescri31807" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/dw.gif" border="0"></a><a onclick="javascript:ec('thisSequenceOfDescri31807','show','https://web.archive.org/web/20160308183811/http://i.opml.org/rw.gif','https://web.archive.org/web/20160308183811/http://i.opml.org/dw.gif');"><span class="spanOutlineText spanExpandableText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">This sequence of descriptive records that would summarize the state of an edited document could be called a piece table. </span></a></p>
		<div class="show" id="thisSequenceOfDescri31807" name="thisSequenceOfDescri31807">
			<div class="divOutlineList" style="padding-left: 30px;">
				<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">J Moore doesn't use that terminology in his original description of the idea in a Xerox technical report. </span></p>
				<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">It appears that Simonyi and his engineers who wrote the Bravo word processor were the first to coin the phrase 'piece table' to describe Moore's innovation. I saw that phrase already used to describe document editing data structures in the source code files of PC Word 1.0 and Mac Word 1.0.</span></p>
				</div>
			</div>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">The resulting three record sequence would describe the new sequence of characters in the document. </span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">Any further editing would fragment the document further, which would require the addition of more piece descriptors to the piece table to describe each fragment that was created.</span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">If one recorded the original piece record list from before an edit,  you could undo an edit by blessing the original piece description that existed before the edit, as the new specification of the document's state.</span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">If you also remembered the after-edit piece description, before doing an undo operation, one only needed to move that small piece table version around in computer memory, rather than moving all of the chararacters they point to, to accomplish a redo.  </span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">So that was the answer that satisfied my how-did-they-do-that curiosity: shuffle tiny records that describe pieces in a few bytes of memory rather than shuffle actual buffer contents that could contain hundreds of thousand or millions of characters into a new order. </span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;" id="i591" werethereotherproper7449><a href="javascript:ec('wereThereOtherProper7449','show','https://web.archive.org/web/20160308183811/http://i.opml.org/rw.gif','https://web.archive.org/web/20160308183811/http://i.opml.org/dw.gif');"><img class="expandIcon" id="img_wereThereOtherProper7449" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/dw.gif" border="0"></a><a onclick="javascript:ec('wereThereOtherProper7449','show','https://web.archive.org/web/20160308183811/http://i.opml.org/rw.gif','https://web.archive.org/web/20160308183811/http://i.opml.org/dw.gif');"><span class="spanOutlineText spanExpandableText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">Were there other properties of the piece table that Microsoft developers were able to exploit for the user's benefit?</span></a></p>
		<div class="show" id="wereThereOtherProper7449" name="wereThereOtherProper7449">
			<div class="divOutlineList" style="padding-left: 30px;">
				<p class="divOutlineItem" style="padding-bottom: 10px;" id="i592"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">One of the banes that early word processor users had to endure was the time that they had to wait whenever they decided to save their documents. </span></p>
				<p class="divOutlineItem" style="padding-bottom: 10px;" id="i593"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">When MacWord ran on early Macs that saved fheir files to that slow variable speed floppy disk drive that shipped with those machines, users always had to wait seconds, sometimes minutes,  for that operation to complete, while the disk drive sang and groaned to record the new document file that was being written. Unfortunately, in early versions of Word a save operation forced the abandonment of the piece table representation of a document's character order. Save had to follow the piece table entries and re-represent the document text as that long, long string of characters. </span></p>
				<p class="divOutlineItem" style="padding-bottom: 10px;" id="i594"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">This was where the piper had to be paid. Every character in the document needed to be touched to construct that long string, and every character had to make that trip down to the document's disk image. Once a save ended,  the previous piece table was thrown away and a new one consisting of a single piece was created to point to the entire extent of that new text string within he saved file. </span></p>
				<p class="divOutlineItem" style="padding-bottom: 10px;" id="i595"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">Starting with Mac Word 3.0, the beginning of Win Word 1.1's lineage, it was possible to fast save a document. A fast save operation, recorded the piece table structure reflecting the document's current editing state into the document file that was being saved. It would locate any pieces that were newly typed or that were copied from another document, and flushed only those characters and their peroperties down to the saved file.</span></p>
				<p class="divOutlineItem" style="padding-bottom: 10px;" id="i597"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">Imagine a million character document, where the user had typed a 'the' string to correct a grammar mistake in their text and copied one sentence into the document to add support to an argument that they were making in their document. If the document could be fast saved, only the new "the" and the copied sentence content plus properties needed to be copied into the saved file. These fast saved additions accumulated in layers at the end of the original Word document file. </span></p>
				<p class="divOutlineItem" style="padding-bottom: 10px;" id="i596"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">Word preferred to save a document via fast save, if the document had already been completely saved once and if there was still space available in Word's internal memory to accomodate a sizeable piece table.  If it could be performed, a small edit to an enormous file could be performed in an eye blink, the performance one expected when software used a piece table to keep track of editing state.</span></p>
				<p class="divOutlineItem" style="padding-bottom: 10px;" id="i598" ifthewordranoutofint4859><a href="javascript:ec('ifTheWordRanOutOfInt4859','show','https://web.archive.org/web/20160308183811/http://i.opml.org/rw.gif','https://web.archive.org/web/20160308183811/http://i.opml.org/dw.gif');"><img class="expandIcon" id="img_ifTheWordRanOutOfInt4859" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/dw.gif" border="0"></a><a onclick="javascript:ec('ifTheWordRanOutOfInt4859','show','https://web.archive.org/web/20160308183811/http://i.opml.org/rw.gif','https://web.archive.org/web/20160308183811/http://i.opml.org/dw.gif');"><span class="spanOutlineText spanExpandableText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">If the Word ran out of internal memory space, one of its go-to-the-lifeboat actions was to force a full save of fast saved documents that had accumulated large piece tables. By spending the time to reorganize the document's text stream  so that its piece table could be discarded, it beacame possible to free up enough memory so that the user could continue to type and edit for a much longer time. </span></a></p>
				<div class="show" id="ifTheWordRanOutOfInt4859" name="ifTheWordRanOutOfInt4859">
					<div class="divOutlineList" style="padding-left: 30px;">
						<p class="divOutlineItem" style="padding-bottom: 10px;" id="i599"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">A flag in a the header of a saved Word doc, fib.fComplex, was set to fTrue whenever that document had been fast saved. The arrangement of text in such documents WAS quite complex, because adjacent text characters recorded in the file may no longer be adjacent in the document's text stream. This caused competitors who wished to read Word documents fits, I had heard, because they had to get used to the unusual geometry of fast saved text. </span></p>
						<p class="divOutlineItem" style="padding-bottom: 10px;" id="i600"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">It was also possible that characters that were still stored in the document file, had been deleted since those characters were first copied into the file. That meant if a user of the program had typed embarassing or incriminating text in a Word document, saved it and then thought better of publishing such thoughts, and erased them, that once saved text still was recorded in a Word file. If you used an operating system utility to dump the raw content of a fast saved Word file, this stuff became visible to the technically minded nosy person. </span></p>
						<p class="divOutlineItem" style="padding-bottom: 10px;" id="i601"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">These were both disadvanatages of providing a fast save facility in Word. </span></p>
						<p class="divOutlineItem" style="padding-bottom: 10px;" id="i602"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">The overriding advantage that made up for these detrments was that the feature could save an intensive user of Word hundreds of hours of otherwise wasted save time per year, which would have interrupted the flow of their writing and document production. I imagine it's effect, as Word gained large market share in the early 90's and before disk drives sped up massively, might been visible as a tiny sliver of a percent of benefit in econometrician's studies of Gross National Product and national productivity. </span></p>
						<p class="divOutlineItem" style="padding-bottom: 10px;" id="i604"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">Even in the most braggadocious mood, you usually couldn't dream to make such a claim for any feature of a software program. Given the wide adoption of Word around the world, the large number of users involved, the necessity for frequent use of the save operation to preserve a user's word processor work, and the slowness of disk drives for an extended period of years, it's pretty certain that fast saving paid off for society and for Microsoft.</span></p>
						</div>
					</div>
				</div>
			</div>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">As a Microsoft sofware developer, I could view the code that performed so marvelously, and I could make small changes to that process to improve its performance and add to the flexibility of its execution in different ways, but I could only show that code to other Microsoft employees, because the details of its operation was protected as a trade secret. </span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">Microsoft's piece table implementation remained a secret until last week, when the company allowed the Computer History Museum to  publish the source code for Windows Word 1.1 on its website for the curious to view. </span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">Despite the fact that Moore's piece table invention was crucial to the development of Bravo and Bravo X at PARC and later Microsoft Word after Simonyi moved to Microsoft, the data structure is little noted in public literature. </span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;" itisgivenanotveryspe8701><a href="javascript:ec('itIsGivenANotVerySpe8701','show','https://web.archive.org/web/20160308183811/http://i.opml.org/rw.gif','https://web.archive.org/web/20160308183811/http://i.opml.org/dw.gif');"><img class="expandIcon" id="img_itIsGivenANotVerySpe8701" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/dw.gif" border="0"></a><a onclick="javascript:ec('itIsGivenANotVerySpe8701','show','https://web.archive.org/web/20160308183811/http://i.opml.org/rw.gif','https://web.archive.org/web/20160308183811/http://i.opml.org/dw.gif');"><span class="spanOutlineText spanExpandableText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">It is given a not-very specific, not really adequate, two sentence description in Wikipedia. Moore's invention of the idea, and its use as foundational technology within Bravo and Word is not mentioned there.</span></a></p>
		<div class="show" id="itIsGivenANotVerySpe8701" name="itIsGivenANotVerySpe8701">
			<div class="divOutlineList" style="padding-left: 30px;">
				<p class="divOutlineItem" style="padding-bottom: 10px;" id="i605"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">It's not Wikipedia's fault. The utility of the piece table could not be verified until instances of these algorithms became available for technical review.</span></p>
				</div>
			</div>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">The discussion page beneath this article indicates that it is rated Low Importance by the WikiProject Computing group within Wikipedia, which is tasked with improving the coverage of computers, computing, and information technology on Wikipedia.</span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">Given the importance of this data structure to the performance and flexibility of operation of Microsoft Word, a software application that has been used by billions, perhaps this article has been misrated. </span></p>
		<p class="divOutlineItem" style="padding-bottom: 10px;" whatsbeenwroughtusin10831><a href="javascript:ec('whatSBeenWroughtUsin10831','show','https://web.archive.org/web/20160308183811/http://i.opml.org/rw.gif','https://web.archive.org/web/20160308183811/http://i.opml.org/dw.gif');"><img class="expandIcon" id="img_whatSBeenWroughtUsin10831" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/dw.gif" border="0"></a><a onclick="javascript:ec('whatSBeenWroughtUsin10831','show','https://web.archive.org/web/20160308183811/http://i.opml.org/rw.gif','https://web.archive.org/web/20160308183811/http://i.opml.org/dw.gif');"><span class="spanOutlineText spanExpandableText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">What's been wrought using piece tables? Answer: The Word formatted documents created by the billion or so peple who have used different version of Microsoft Word since it's introduction.  </span></a></p>
		<div class="show" id="whatSBeenWroughtUsin10831" name="whatSBeenWroughtUsin10831">
			<div class="divOutlineList" style="padding-left: 30px;">
				<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">I haven't spoken yet about another aspect of piece tables. There's a field in a piece description, the pcd.prm, that records any formatting change that has been made to the character, paragraph or table properties within the run of text in the document described by that piece description, since the time that piece was first created.  </span></p>
				<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">This 16 bit quantity, if it is non-zero, can point to a heap block in Word's internal heap that describes how the properties of that block differ from the default settings of those properties. </span></p>
				<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">Using this scheme, hundreds of bytes of property data for a piece could frequently be specified using only a few bytes of descriptive data.</span></p>
				<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">This whole aspect of Word's design is pretty amazing and deserves study. I promise another article that will describe how this part of the design worked.</span></p>
				</div>
			</div>
		<p class="divOutlineItem" style="padding-bottom: 10px;" id="i590" atourthroughthepiece23461><a href="javascript:ec('aTourThroughThePiece23461','show','https://web.archive.org/web/20160308183811/http://i.opml.org/rw.gif','https://web.archive.org/web/20160308183811/http://i.opml.org/dw.gif');"><img class="expandIcon" id="img_aTourThroughThePiece23461" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/dw.gif" border="0"></a><a onclick="javascript:ec('aTourThroughThePiece23461','show','https://web.archive.org/web/20160308183811/http://i.opml.org/rw.gif','https://web.archive.org/web/20160308183811/http://i.opml.org/dw.gif');"><span class="spanOutlineText spanExpandableText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">A tour through the piece table related code for software developers</span></a></p>
		<div class="show" id="aTourThroughThePiece23461" name="aTourThroughThePiece23461">
			<div class="divOutlineList" style="padding-left: 30px;">
				<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">To see the definition of a single piece table descriptor in the Word 1.1 archive, look for the definition of PCD (piece descriptor) in  Opus/Wordtech/doc.h. </span></p>
				<p class="divOutlineItem" style="padding-bottom: 10px;" thecompletepiecetabl7536><a href="javascript:ec('theCompletePieceTabl7536','show','https://web.archive.org/web/20160308183811/http://i.opml.org/rw.gif','https://web.archive.org/web/20160308183811/http://i.opml.org/dw.gif');"><img class="expandIcon" id="img_theCompletePieceTabl7536" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/dw.gif" border="0"></a><a onclick="javascript:ec('theCompletePieceTabl7536','show','https://web.archive.org/web/20160308183811/http://i.opml.org/rw.gif','https://web.archive.org/web/20160308183811/http://i.opml.org/dw.gif');"><span class="spanOutlineText spanExpandableText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">The complete piece table for a document was stored in a structure called a PLCPCD. A PLC was a dynamic generalization of an array (dynamic means its size could grown and shrunk under program control during execution) that packaged into one heap block an array of character positions (CPs) in one-to-one correspondence with an array of PCDs, which was recorded immediately after the array of CPs in the heap block. </span></a></p>
				<div class="show" id="theCompletePieceTabl7536" name="theCompletePieceTabl7536">
					<div class="divOutlineList" style="padding-left: 30px;">
						<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">One could not write a single C expression which would give you access to the data strored past pcd.rgcp. One is not allowed to declare a variable length array that follows another variable length array inside of a C structure definition.</span></p>
						<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">Instead one could write generic get and set access routines, that would do calculations to reach below the rgcp allocation and grab or stuff a data payload in its own slot within the heap allocation. </span></p>
						</div>
					</div>
				<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">You'll find definition of the PLC also in Opus/Wordtech/doc.h. You'll see that a DOD (document descriptor structure defined in doc.h) defines a hplcpcd, which is a document's piece table. PLCs are created by HplcInit() in Opus/wordtech/clsplc.c. GetPlc() and PutPlc() are the getter and setter routines for that retrieve and send a payload data structure to a PLC. </span></p>
				<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">FOpenPlc(), which grows and shrinks PLCs, and FInsertInPlc(), which adds a new payload structure to a plc at a given CP coordinate,  are found in Opus/wordtech/clsplc.c</span></p>
				<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">The distance between two adjacent character positions in the array of CPs was the size of a piece. </span></p>
				<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">Because it takes n+1 points to determine the bounds of n intervals, the 1-to-1 correspondence maintained within a PLCPCD was between beginning CPs of pieces and the PCDs in the following PCD array. </span></p>
				<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">The final CP in the CP array was only an end of piece coordinate. Since it did not start a piece, unlike all of the earlier CPs in its array, it did not have a corresponding PCD structure recorded in the array of PCDs.</span></p>
				<p class="divOutlineItem" style="padding-bottom: 10px;" mostoftheprimitivero28215><a href="javascript:ec('mostOfThePrimitiveRo28215','show','https://web.archive.org/web/20160308183811/http://i.opml.org/rw.gif','https://web.archive.org/web/20160308183811/http://i.opml.org/dw.gif');"><img class="expandIcon" id="img_mostOfThePrimitiveRo28215" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/dw.gif" border="0"></a><a onclick="javascript:ec('mostOfThePrimitiveRo28215','show','https://web.archive.org/web/20160308183811/http://i.opml.org/rw.gif','https://web.archive.org/web/20160308183811/http://i.opml.org/dw.gif');"><span class="spanOutlineText spanExpandableText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">Most of the primitive routines that acted on a piece table can mostly be found in Opus/edit.c.</span></a></p>
				<div class="show" id="mostOfThePrimitiveRo28215" name="mostOfThePrimitiveRo28215">
					<div class="divOutlineList" style="padding-left: 30px;">
						<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">The routine that split a piece table at a specified CP position in preparation for insertion or deletion was called IpcdSplit(). </span></p>
						<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">The routine that created a new piece to describe text that was newly typed and inserted that new piece into the piece table, in order to replace a target CP range, was called FReplace().</span></p>
						<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">Using FReplace() to insert a zero-length piece to replace a CP range, performed a text deletion operation.</span></p>
						<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">The routine that was used to copy a run of characters from one document to another, perturbing the destination piece table to record the edit, was called FReplaceCps().</span></p>
						</div>
					</div>
				<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">The routine that created a single entry piece table that described the entire range of text within a full saved document was FInitPlcpcd() in Opus/create2.c</span></p>
				<p class="divOutlineItem" style="padding-bottom: 10px;" id="i603"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">The routine that performed a fast save operation was FQuickSave(),  which can be found in Opus/wordtech/savefast.c</span></p>
				</div>
			</div>
		<p class="divOutlineItem" style="padding-bottom: 10px;"><img class="expandIcon" src="https://web.archive.org/web/20160308183811im_/http://i.opml.org/bw.gif" border="0"><span class="spanOutlineText" style="font-family: 'Helvetica Neue',Helvetica,Arial,sans-serif; font-size: 18px; line-height: 130%;">If you have any questions about any of this, leave them in the Disqus comment thread below. I'll answer as I notice them. </span></p>
		</div>
	</div>

						</div>
					

<div class="divComments">
	<div id="disqus_thread"></div>
	<script type="text/javascript" src="https://web.archive.org/web/20160308183811js_/http://disqus.com/forums/songtrellisoutlines/embed.js"></script>
	<noscript><a href="https://web.archive.org/web/20160308183811/http://songtrellisoutlines.disqus.com/?url=ref">View the forum thread.</a></noscript>
	</div>

					
					</div>
				<div class="divOpmlFooter">
					<div class="divEditButton"><script type="text/javascript" src="https://web.archive.org/web/20160308183811js_/http://127.0.0.1:5337/opmlEditor/editOutlineButton/show?root=http://s3.amazonaws.com/songtrellis/davidlu/2014/04/01/archive019.opml&amp;username=davidlu&amp;editorialDomain=songtrellisopml.com&amp;title=Untitled&amp;domain=1017.songtrellisopml.com"></script></div><div class="divXmlIcon"><a href="?format=opml" title="Click on this icon to view the OPML source text for this page."><img class="imgXmlIcon" src="https://web.archive.org/web/20160308183811im_/http://scripting.com/images/xmlIcon2.gif" border="0" width="36" height="14" alt="XML"/></a>
</div>
					</div>
				</div>
			</div>
		</body>
	</html>
<!--
     FILE ARCHIVED ON 18:38:11 Mar 08, 2016 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 20:48:12 Apr 27, 2022.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  captures_list: 162.064
  exclusion.robots: 0.142
  exclusion.robots.policy: 0.135
  RedisCDXSource: 0.803
  esindex: 0.006
  LoadShardBlock: 144.763 (3)
  PetaboxLoader3.datanode: 54.678 (4)
  CDXLines.iter: 14.556 (3)
  load_resource: 436.435
  PetaboxLoader3.resolve: 399.907
-->